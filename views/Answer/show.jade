extends ../layout 

block content
  script. 
    var answer = "#{answer_string}";
  script(type="application/javascript", src="/javascripts/answers/show.js")
  
  .row.large-12.columns
    //- p #{answer}
    if !user 
      h1 Showing answer
    else if !user.isEducator
      h1 Showing answer
    else if visitorIsOwner
      h1 Showing Your Answer 
    else if user.isEducator
      h1 Showing answer (educator view)
      
    hr 
    h3 
      u Question:
      |  #{answer.question.questionText}
    include ../JSME/showanswer.html
    hr 
    if user 
      if user.isEducator
        .callout.text-center
          h1 Edit history
          table(align='center')
            thead 
              th Number 
              th Time 
              th Action 
              th Bond
            tody 
            each m in answer.molecule[0].editHistory 
              tr 
                td #{m.number}
                td #{m.time}
                td #{m.action}
                td #{m.bond}
          
    
    if feedbacks.length > 0
      h3 Existing Feedback: 
      each f in feedbacks
        .row.large-12.columns
          
          if f.isForSpecificAnswer
            .div.callout.success
              b Mark: 
                | #{f.mark} 
              p #{f.feedbackText}
              hr
              div(align='center')
                h6 (Note: This feedback was given to this answer in specific)
          
          else 
            .callout.alert 
              b Mark: 
                | #{f.mark} 
              p #{f.feedbackText}
              hr
              div(align='center')
                h6 (Note: This feedback was given to all respondents who gave the structure you did)
          
            
    else 
      h3 No feedback given yet
    
    
    if !visitorIsOwner
      h2 Provide feedback on answer (not owner)
      form(id="createFeedbackFrom", method="post", action="/feedback/new")
        input(type='hidden', name='isForSpecificAnswer', value="true")
        input(type='hidden', name='answer_id', value="#{answer._id}")
        input(type='hidden', name='question_id', value="#{answer.question._id}")
        input(type='text', name='mark', placeholder='What mark would you award this?')
        textarea(rows='4', name='feedbackText', placeholder='Give a textual explanation of your above mark here')
        input(type='submit', class='button', value='Submit')
    else 
      h2 Self Assessment
      form(id="selfAssessmentForm", method="post", action="/feedback/newselfassessment")
        input(type='hidden', name='answer_id', value='#{answer._id}')
        input(type='text', name='mark', placeholder='What mark would you award this?')
        textarea(rows='4', name='feedbackText', placeholder='Give a textual explanation of your above mark here')
        input(type='submit', class='button', value='Submit')
        
    
